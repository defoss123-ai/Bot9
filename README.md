# Флиппинг-бот для MEXC с веб-интерфейсом

Асинхронный торговый бот для фьючерсов MEXC (USDT-M), реализующий стратегию флиппинга на 1-минутных свечах (пробой локальных уровней с подтверждением объёма). Управление выполняется через веб-интерфейс на Bootstrap 5.

## Структура проекта

```text
project_root/
│
├── main.py
├── pair_manager.py
├── signal_generator.py
├── trader.py
├── web_interface.py
├── db_logger.py
├── requirements.txt
├── README.md
├── .env.example
├── master.key              # создаётся автоматически при первом запуске
├── operations.log          # создаётся автоматически
├── bot.log                 # создаётся автоматически
├── trading_bot.db          # создаётся автоматически
│
├── templates/
│   └── index.html
│
└── static/
```

> `master.key`, `operations.log`, `bot.log`, `trading_bot.db` не нужно добавлять в git.

## Установка

1. Убедитесь, что установлен Python 3.9+.
2. Клонируйте репозиторий (или скопируйте файлы) и перейдите в папку проекта.
3. Создайте виртуальное окружение:

```bash
python -m venv venv
```

4. Активируйте окружение:
   - Windows:

```bash
venv\Scripts\activate
```

   - macOS/Linux:

```bash
source venv/bin/activate
```

5. Установите зависимости:

```bash
pip install -r requirements.txt
```

## Первый запуск и настройка

1. Запустите бота:

```bash
python main.py
```

2. Откройте браузер: `http://127.0.0.1:5000`.
3. На вкладке **API** введите ключи MEXC и нажмите **Сохранить**, затем **Проверить подключение**.
4. Если ключи добавлены впервые, перезапустите бота (`Ctrl+C` и снова `python main.py`) для старта торгового цикла.
5. На вкладке **Пары** добавьте символы (например `BTCUSDT`) и параметры (плечо, TP/SL, автоотмена).
6. На вкладке **Стратегия** задайте `lookback`, `volume multiplier`, интервал проверки.
7. На вкладках **Статистика** и **Логи** отслеживайте состояние и события.

## Использование веб-интерфейса

- Интерфейс адаптивный (Bootstrap 5).
- Обновление данных происходит через AJAX (`fetch`).
- Есть вкладки: **API**, **Пары**, **Стратегия**, **Статистика**, **Логи**.
- Логи и статистика обновляются автоматически.

## Безопасность

- API-ключи хранятся в SQLite только в зашифрованном виде (`cryptography.fernet`).
- `master.key` создаётся при первом запуске. Храните его безопасно: без него нельзя расшифровать ключи.
- Для production рекомендуется reverse proxy + HTTPS и ограничение доступа к веб-порту.

## Файлы и логи

- `trading_bot.db` — база данных (настройки, позиции, ордера, логи).
- `operations.log` — операционный текстовый лог.
- `bot.log` — подробный runtime-лог.
- `master.key` — мастер-ключ шифрования.

## Возможные проблемы и решения

### Port 5000 already in use

Измените порт в окружении:

```bash
# Linux/macOS
export QUART_PORT=5001
python main.py
```

```bash
# Windows
set QUART_PORT=5001
python main.py
```

### Проблемы установки cryptography на Windows

Установите Microsoft C++ Build Tools: https://visualstudio.microsoft.com/visual-cpp-build-tools/

### После сохранения ключей бот не торгует

Перезапустите бота (временное ограничение текущей версии).

### Не появляются сигналы

Проверьте, что пара включена и накоплено достаточно 1m-свечей.

## Отказ от ответственности

Проект предоставляется «как есть» для образовательных целей. Использование в реальной торговле — на ваш риск. Автор не несёт ответственности за возможные финансовые потери.

## Лицензия

MIT.
